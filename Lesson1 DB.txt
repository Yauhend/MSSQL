USE YAUHEN1;
CREATE TABLE STUDENTS
(ID INT NOT NULL IDENTITY ,
FIRST_NAME VARCHAR(50),
SECOND_NAME VARCHAR(50),
SURNAME VARCHAR(50),
GROUP_ID INT,
CONSTRAINT PK_STUDENTS PRIMARY KEY(ID)
);
CREATE TABLE TEACHERS
(
ID INT NOT NULL IDENTITY,
FIRST_NAME VARCHAR(50),
SECOND_NAME VARCHAR(50),
SURNAME VARCHAR(50),
CONSTRAINT PK_TEACHERS PRIMARY KEY(ID)
);
CREATE TABLE GROUPS
(
ID INT NOT NULL IDENTITY CONSTRAINT PK_GROUPS PRIMARY KEY,
NAME VARCHAR(50),
COURSE INT
)
CREATE TABLE PPLAN
(
GROUP_ID INT NOT NULL,
TEACHER_ID INT NOT NULL,
SUBJECT_ID INT NOT NULL,
CONSTRAINT PK_PPLAN PRIMARY KEY(GROUP_ID, TEACHER_ID, SUBJECT_ID)
)
CREATE TABLE SUBJECTS
(
ID INT NOT NULL IDENTITY CONSTRAINT PK_SUBJECTS PRIMARY KEY,
NAME VARCHAR(50),
HOURS INT
)

ALTER TABLE STUDENTS ADD CONSTRAINT FK_GROUPS FOREIGN KEY (GROUP_ID) REFERENCES GROUPS(ID);
ALTER TABLE PPLAN ADD CONSTRAINT FK_TEACHERS FOREIGN KEY (TEACHER_ID) REFERENCES TEACHERS(ID);
ALTER TABLE PPLAN ADD CONSTRAINT FK_PPLANGROUPS FOREIGN KEY (GROUP_ID) REFERENCES GROUPS(ID);
ALTER TABLE PPLAN ADD CONSTRAINT FK_SUBJECTS FOREIGN KEY (SUBJECT_ID) REFERENCES SUBJECTS(ID);
INSERT INTO GROUPS(NAME,COURSE)
VALUES ('ПО135',1),('ПО134',1),('ПО235',2),('ПО335',3);
SELECT * FROM GROUPS; 
INSERT INTO STUDENTS
VALUES ('ФЕДОРЕНКО','П','М',1),('ПЕТРЕНКО','Р','С',1),('ПУЛЯГИН','А','И',2),('СЛЕПУК','И','В',3),('СЛОНЕВИЧ','У','П',3),('ПЛЮЩЕВ','З','З',4);
SELECT * FROM STUDENTS;
INSERT INTO TEACHERS
VALUES ('ЛАЗАРЕВА','П','М'),('СОВЕНОК','Р','С'),('ТУТОНЕВ','А','И'),('ПОВОРОПУК','И','В'),('ВЕРХНИЕВИЧ','У','П'),('САРОЯН','З','З');
SELECT * FROM TEACHERS;
INSERT INTO SUBJECTS
VALUES ('ФИЗИКА',120),('МАТЕМАТИКА',210),('ИСТОРИЯ',11),('ЛОГИКА',100),('БИОЛОГИЯ',181),('ТРУДЫ',500);
INSERT INTO PPLAN
VALUES (1,1,1),(2,1,1),(3,2,2),(2,2,2),(4,4,4),(4,3,3);

UPDATE STUDENTS
SET GROUP_ID = (SELECT ID FROM GROUPS WHERE NAME='ПО135')
WHERE GROUP_ID = (SELECT ID FROM GROUPS WHERE NAME='ПО134');
---------------- NEW PART-------------
DELETE FROM PPLAN
WHERE GROUP_ID = (SELECT ID FROM GROUPS WHERE NAME = 'ПО134');
DELETE FROM GROUPS
WHERE NAME =  'ПО134';
UPDATE SUBJECTS
SET HOURS = HOURS+30
WHERE NAME IN ('ЛОГИКА','ТРУДЫ');
ALTER TABLE SUBJECTS
ADD FORM_OF_CONTROL VARCHAR(50);
UPDATE SUBJECTS
SET FORM_OF_CONTROL = 'ЗАЧЁТ'
WHERE NAME = 'ТРУДЫ';
UPDATE SUBJECTS
SET FORM_OF_CONTROL = 'ЭКЗАМЕН'
WHERE NAME <> 'ТРУДЫ';
ALTER TABLE STUDENTS
DROP COLUMN SURNAME;
ALTER TABLE TEACHERS
DROP COLUMN SURNAME;



SELECT * FROM GROUPS;
SELECT * FROM STUDENTS;
SELECT * FROM PPLAN;
SELECT * FROM SUBJECTS;


